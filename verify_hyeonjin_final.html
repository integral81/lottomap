<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>í˜„ì§„ì‹í’ˆ POV ìµœì¢… ì¡°ì •</title>
    <style>
        body {
            font-family: 'Malgun Gothic';
            text-align: center;
            margin: 0;
            padding: 0;
            background: #333;
            color: white;
        }

        #roadview {
            width: 100%;
            height: 80vh;
        }

        .controls {
            padding: 20px;
            background: #222;
        }

        .value-box {
            font-size: 1.5em;
            color: #fae100;
            font-weight: bold;
            margin-top: 10px;
        }

        button {
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
        }
    </style>
    <script type="text/javascript"
        src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=84b62e85ed3ec32fca558717eda26006"></script>
</head>

<body>
    <div class="controls">
        <h2>ğŸ› ï¸ í˜„ì§„ì‹í’ˆ (PanoID: 1198607745)</h2>
        <div>ë§ˆìš°ìŠ¤ë¡œ ë¡œë“œë·°ë¥¼ ëŒë ¤ <b>ê°€ê²Œ ì •ë©´</b>ì„ ë§ì¶°ì£¼ì„¸ìš”.</div>
        <div class="value-box">
            í˜„ì¬ ê°ë„(Pan): <span id="pan-val">0.0</span>
        </div>
    </div>
    <div id="roadview"></div>
    <script>
        var rvContainer = document.getElementById('roadview');
        var rv = new kakao.maps.Roadview(rvContainer);
        var rc = new kakao.maps.RoadviewClient();
        var panSpan = document.getElementById('pan-val');

        // Target Location
        var position = new kakao.maps.LatLng(37.500768, 126.863857);

        // 1. Try to load specific PanoID first
        var targetPanoId = 1198607745;

        function initRoadview(panoId) {
            rv.setPanoId(panoId, position);

            // Add Direct Link Button dynamically
            var btn = document.createElement("button");
            btn.innerText = "ğŸš¨ ê²€ì€ í™”ë©´ì´ ëœ¨ë©´ ì—¬ê¸° í´ë¦­ (ì¹´ì¹´ì˜¤ë§µ ë°”ë¡œê°€ê¸°)";
            btn.style.marginTop = "10px";
            btn.style.backgroundColor = "#ff5555";
            btn.onclick = function () {
                window.open("https://map.kakao.com/?panoid=" + panoId + "&pan=0&tilt=0&zoom=0", "_blank");
            };
            document.querySelector('.controls').appendChild(btn);
        }

        // Try to find the nearest PanoID again to be safe
        rc.getNearestPanoId(position, 50, function (panoId) {
            if (panoId) {
                console.log("Found PanoID: " + panoId);
                // If the hardcoded one is different, maybe use the fresh one?
                // Let's stick to the fresh one.
                initRoadview(panoId);

                kakao.maps.event.addListener(rv, 'init', function () {
                    kakao.maps.event.addListener(rv, 'viewpoint_changed', function () {
                        var vp = rv.getViewpoint();
                        panSpan.innerText = vp.pan.toFixed(1);
                    });
                });
            } else {
                alert("ë°˜ê²½ 50m ë‚´ì— ë¡œë“œë·°ê°€ ì—†ìŠµë‹ˆë‹¤! (ì¢Œí‘œ í™•ì¸ í•„ìš”)");
            }
        });
    </script>
</body>

</html>