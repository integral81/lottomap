
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="utf-8">
        <title>KINOV Lotto Final Map</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
        <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
        <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
        <style>
            body { margin: 0; font-family: 'Segoe UI', serif; }
            #map { position: absolute; top: 0; bottom: 0; width: 100%; }
            #panel {
                position: absolute; top: 15px; right: 15px; background: white;
                padding: 20px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000; width: 300px;
            }
            h3 { margin: 0 0 15px; color: #d32f2f; font-size: 18px; text-align: center; }
            .filter-sec { margin-bottom: 20px; }
            .filter-title { font-weight: bold; margin-bottom: 8px; display: block; font-size: 14px; }
            .inp-grp { display: flex; gap: 8px; align-items: center; }
            input[type="number"] { width: 80px; padding: 6px; border: 1px solid #ddd; border-radius: 4px; }
            .btn {
                width: 100%; padding: 12px; background: #d32f2f; color: white;
                border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px;
            }
            .stats { margin-top: 15px; background: #f9f9f9; padding: 10px; border-radius: 6px; font-size: 12px; }
            .stats b { color: #d32f2f; }
        </style>
    </head>
    <body>
        <div id="map"></div>
        <div id="panel">
            <h3>ğŸ° KINOV LOTTO MAP</h3>
            <div class="filter-sec">
                <span class="filter-title">ğŸ“… íšŒì°¨ ë²”ìœ„</span>
                <div class="inp-grp">
                    <input type="number" id="minR" value="262"> ~ 
                    <input type="number" id="maxR" value="1209">
                </div>
            </div>
            <div class="filter-sec">
                <span class="filter-title">ğŸ² ë‹¹ì²¨ ë°©ì‹</span>
                <label><input type="checkbox" id="chkA" checked> ìë™</label> &nbsp;
                <label><input type="checkbox" id="chkM" checked> ìˆ˜ë™</label>
            </div>
            <button class="btn" onclick="applyFilters()">í•„í„° ì ìš©</button>
            <div class="stats">
                ì „ì²´: <b>66</b>ê±´<br>
                í˜„ì¬: <b id="curCnt">-</b>ê±´
            </div>
        </div>

        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
        <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
        <script>
            const data = [{"r": 1209, "n": "ì§„ì–‘í˜¸", "a": "ê²½ë‚¨ ì§„ì£¼ì‹œ ë‚¨ê°•ë¡œ 58 1ì¸µ", "m": "ë°˜ìë™", "lat": 35.1628066, "lng": 128.0484149}, {"r": 1209, "n": "ê´‘ë‚˜ë£¨ë³µê¶Œë°©", "a": "ì„œìš¸ ê´‘ì§„êµ¬ ì•„ì°¨ì‚°ë¡œ 591", "m": "ìë™", "lat": 37.5407462, "lng": 127.0684171}, {"r": 1209, "n": "ì½”ë¦¬ì•„25ì˜¥ê³„ì ", "a": "ê²½ë¶ êµ¬ë¯¸ì‹œ ì‚°í˜¸ëŒ€ë¡œ25ê¸¸ 18-4", "m": "ìë™", "lat": 36.1399399, "lng": 128.4168846}, {"r": 1209, "n": "ëª…ë‹¹ë¡œë˜ í’ë‚¨ë¬¸ì ", "a": "ì „ë¶ ì „ì£¼ì‹œ ì™„ì‚°êµ¬ í’ë‚¨ë¬¸2ê¸¸ 34", "m": "ìë™", "lat": 35.8132051, "lng": 127.1439502}, {"r": 1209, "n": "ë™ë‚¨ìŠˆí¼", "a": "ì „ë¶ ë¶€ì•ˆêµ° ë²ˆì˜ë¡œ 173", "m": "ìë™", "lat": 35.727194, "lng": 126.7392691}, {"r": 1209, "n": "ëª…ì„±ë³µê¶Œë°©", "a": "ê²½ê¸° í™”ì„±ì‹œ ê²½ê¸°ëŒ€ë¡œ 1043", "m": "ìˆ˜ë™", "lat": 37.2112376, "lng": 127.0323071}, {"r": 1209, "n": "ì˜¬ì¸ (all in)", "a": "ê²½ê¸° í™”ì„±ì‹œ 3.1ë§Œì„¸ë¡œ 1147", "m": "ìë™", "lat": 37.1139739, "lng": 126.8858004}, {"r": 1209, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 1209, "n": "ê°‘ë¶€ë³µê¶ŒíŒë§¤ì ", "a": "ì„œìš¸ ìš©ì‚°êµ¬ ëŒ€ì‚¬ê´€ë¡œ 80", "m": "ìˆ˜ë™", "lat": 37.5349534, "lng": 126.9992939}, {"r": 1209, "n": "ì–´ì¸ìœ„í¬", "a": "ì„œìš¸ ì¤‘êµ¬ í‡´ê³„ë¡œ87ê¸¸ 41 1ì¸µ", "m": "ìˆ˜ë™", "lat": 37.5674221, "lng": 127.020975}, {"r": 1209, "n": "ë³µê¶Œë‚˜ë¼(ì¤‘í¥ì )", "a": "ê´‘ì£¼ ë¶êµ¬ ìš°ì¹˜ë¡œ 26-1", "m": "ìë™", "lat": 35.2241683, "lng": 126.9017996}, {"r": 1209, "n": "ë™ì¸ì²œí™©ê¸ˆë¡œë˜", "a": "ì¸ì²œ ì¤‘êµ¬ ì°¸ì™¸ì „ë¡œ 110 1ì¸µ", "m": "ìë™", "lat": 37.470482, "lng": 126.6383959}, {"r": 1209, "n": "ëŒ€ë°•ì‹ í™”ë³µê¶ŒíŒë§¤ì ", "a": "ì¸ì²œ ë¯¸ì¶”í™€êµ¬ ì¸í•˜ë¡œ 267", "m": "ìë™", "lat": 37.4483289, "lng": 126.6756083}, {"r": 1209, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1208, "n": "ë¡œë˜ë³µê¶Œ", "a": "ê²½ê¸° ì˜¤ì‚°ì‹œ ì„±í˜¸ìƒˆì‹¹ê¸¸ 11", "m": "ìë™", "lat": 37.1521886, "lng": 127.070315}, {"r": 1208, "n": "ê³ ì²™ëŒ€ë°•ë³µê¶Œ&ì¹´í˜", "a": "ì„œìš¸ êµ¬ë¡œêµ¬ ê²½ì¸ë¡œ47ê¸¸ 68 1ì¸µ(ê³ ì²™ë™)", "m": "ìë™", "lat": 37.5014274, "lng": 126.8652586}, {"r": 1207, "n": "ë¡œë˜ëª…ë‹¹ì§„í•˜ì ", "a": "ìš¸ì‚° ìš¸ì£¼êµ° í•´ë§ì´ë¡œ 1578", "m": "ìë™", "lat": 35.4044828, "lng": 129.3432813}, {"r": 1207, "n": "ê³ ì–‘í–‰ë³µë³µê¶Œ", "a": "ê²½ê¸° ê³ ì–‘ì‹œ ë•ì–‘êµ¬ ì‚¼ì†¡ë¡œ 142", "m": "ìë™", "lat": 37.6523029, "lng": 126.8898374}, {"r": 1207, "n": "ì‚¼ì„±ë³µê¶Œë°©", "a": "ê²½ê¸° ë™ë‘ì²œì‹œ ì–´ìˆ˜ë¡œ 100-1", "m": "ìë™", "lat": 37.9027663, "lng": 127.0514028}, {"r": 1207, "n": "ë¡œë˜ì¹´í˜", "a": "ê²½ê¸° í‰íƒì‹œ ê´€ê´‘íŠ¹êµ¬ë¡œ 13 1ì¸µ102í˜¸", "m": "ìë™", "lat": 37.0668863, "lng": 127.0614119}, {"r": 1207, "n": "ì²œí•˜ëª…ë‹¹ì´ˆëŸ‰ì ", "a": "ë¶€ì‚° ë™êµ¬ ì¤‘ì•™ëŒ€ë¡œ221ë²ˆê¸¸ 3", "m": "ìë™", "lat": 35.1173268, "lng": 129.0391883}, {"r": 1207, "n": "ëŒ€ì‚°ìŠˆí¼", "a": "ì¶©ë‚¨ ì²œì•ˆì‹œ ë™ë‚¨êµ¬ ë³µêµ¬ì •3ê¸¸ 1", "m": "ìˆ˜ë™", "lat": 36.7692051, "lng": 127.2499871}, {"r": 1207, "n": "ì œì¼ë§ˆíŠ¸", "a": "ì „ë¶ êµ°ì‚°ì‹œ ì§„í¬ë¡œ 145", "m": "ìë™", "lat": 35.9804868, "lng": 126.7325292}, {"r": 1207, "n": "í„°ë¯¸ë„ë¶„ì‹", "a": "ì¶©ë‚¨ ë¶€ì—¬êµ° ë¶€ì¥ëŒ€ë¡œ 65", "m": "ìë™", "lat": 36.278449, "lng": 126.9075881}, {"r": 1207, "n": "í–‰ìš´ì˜ëª…ë‹¹ë¡œ-í† í† ", "a": "ì¶©ë¶ ì²­ì£¼ì‹œ ì„œì›êµ¬ ëª¨ì¶©ë¡œ 36", "m": "ìë™", "lat": 36.6250408, "lng": 127.4671641}, {"r": 1207, "n": "í¸ì˜ì ì‚¬ë‘", "a": "ì„œìš¸ ê°•ì„œêµ¬ ê³°ë‹¬ë˜ë¡œ25ê¸¸ 57 1ì¸µ", "m": "ìˆ˜ë™", "lat": 37.5325782, "lng": 126.8487574}, {"r": 1207, "n": "í¸ì˜ì ì‚¬ë‘", "a": "ì„œìš¸ ê°•ì„œêµ¬ ê³°ë‹¬ë˜ë¡œ25ê¸¸ 57 1ì¸µ", "m": "ìˆ˜ë™", "lat": 37.5325782, "lng": 126.8487574}, {"r": 1207, "n": "ì˜ì›”ë¡œë˜ëª…ë‹¹", "a": "ê°•ì› ì˜ì›”êµ° ì¤‘ì•™ë¡œ 44", "m": "ìë™", "lat": 37.183484, "lng": 128.4704471}, {"r": 1195, "n": "í¸ì˜ì ì‚¬ë‘", "a": "ì„œìš¸ ê°•ì„œêµ¬ ê³°ë‹¬ë˜ë¡œ25ê¸¸ 57 1ì¸µ", "m": "ìë™", "lat": 37.5325782, "lng": 126.8487574}, {"r": 1194, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìˆ˜ë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1183, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 1173, "n": "ëŒ€ì‚°ìŠˆí¼", "a": "ì¶©ë‚¨ ì²œì•ˆì‹œ ë™ë‚¨êµ¬ ë³µêµ¬ì •3ê¸¸ 1", "m": "ìˆ˜ë™", "lat": 36.7692051, "lng": 127.2499871}, {"r": 1165, "n": "ëŒ€ì‚°ìŠˆí¼", "a": "ì¶©ë‚¨ ì²œì•ˆì‹œ ë™ë‚¨êµ¬ ë³µêµ¬ì •3ê¸¸ 1", "m": "ìë™", "lat": 36.7692051, "lng": 127.2499871}, {"r": 1164, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1161, "n": "ëŒ€ë°•ì‹ í™”ë³µê¶ŒíŒë§¤ì ", "a": "ì¸ì²œ ë¯¸ì¶”í™€êµ¬ ì¸í•˜ë¡œ 267", "m": "ìˆ˜ë™", "lat": 37.4483289, "lng": 126.6756083}, {"r": 1150, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1137, "n": "ëŒ€ì‚°ìŠˆí¼", "a": "ì¶©ë‚¨ ì²œì•ˆì‹œ ë™ë‚¨êµ¬ ë³µêµ¬ì •3ê¸¸ 1", "m": "ìˆ˜ë™", "lat": 36.7692051, "lng": 127.2499871}, {"r": 1128, "n": "ëª…ì„±ë³µê¶Œë°©", "a": "ê²½ê¸° í™”ì„±ì‹œ ê²½ê¸°ëŒ€ë¡œ 1043", "m": "ìˆ˜ë™", "lat": 37.2112376, "lng": 127.0323071}, {"r": 1128, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 1121, "n": "ë¡œë˜ì¹´í˜", "a": "ê²½ê¸° í‰íƒì‹œ ê´€ê´‘íŠ¹êµ¬ë¡œ 13 1ì¸µ102í˜¸", "m": "ìˆ˜ë™", "lat": 37.0668863, "lng": 127.0614119}, {"r": 1119, "n": "ì˜¬ì¸(allin)", "a": "ê²½ê¸° í™”ì„±ì‹œ 3.1ë§Œì„¸ë¡œ 1147", "m": "ìë™", "lat": 37.1139739, "lng": 126.8858004}, {"r": 1106, "n": "ë™ì¸ì²œí™©ê¸ˆë¡œë˜", "a": "ì¸ì²œ ì¤‘êµ¬ ì°¸ì™¸ì „ë¡œ 110 1ì¸µ", "m": "ìë™", "lat": 37.470482, "lng": 126.6383959}, {"r": 1106, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 1096, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1085, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 1084, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1073, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1061, "n": "ì½”ë¦¬ì•„25ì˜¥ê³„ì ", "a": "ê²½ë¶ êµ¬ë¯¸ì‹œ ì‚°í˜¸ëŒ€ë¡œ25ê¸¸ 18-4", "m": "ìˆ˜ë™", "lat": 36.1399399, "lng": 128.4168846}, {"r": 1058, "n": "í¸ì˜ì ì‚¬ë‘", "a": "ì„œìš¸ ê°•ì„œêµ¬ ê³°ë‹¬ë˜ë¡œ25ê¸¸ 57 1ì¸µ", "m": "ìˆ˜ë™", "lat": 37.5325782, "lng": 126.8487574}, {"r": 1057, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1048, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 1043, "n": "ì§„ì–‘í˜¸", "a": "ê²½ë‚¨ ì§„ì£¼ì‹œ ë‚¨ê°•ë¡œ 58 1ì¸µ", "m": "ìë™", "lat": 35.1628066, "lng": 128.0484149}, {"r": 1041, "n": "ëŒ€ì‚°ìŠˆí¼", "a": "ì¶©ë‚¨ ì²œì•ˆì‹œ ë™ë‚¨êµ¬ ë³µêµ¬ì •3ê¸¸ 1", "m": "ìë™", "lat": 36.7692051, "lng": 127.2499871}, {"r": 1039, "n": "ì•Œë¦¬ë°”ì´", "a": "ê´‘ì£¼ ê´‘ì‚°êµ¬ ìˆ˜ë“±ë¡œ 253 1ì¸µ ì•Œë¦¬ë°”ì´", "m": "ìë™", "lat": 35.1854045, "lng": 126.8366251}, {"r": 1035, "n": "ì˜ì›”ë¡œë˜ëª…ë‹¹", "a": "ê°•ì› ì˜ì›”êµ° ì¤‘ì•™ë¡œ 44", "m": "ìë™", "lat": 37.183484, "lng": 128.4704471}, {"r": 1019, "n": "ë¡œë˜ë³µê¶Œ", "a": "ê²½ê¸° ì˜¤ì‚°ì‹œ ì„±í˜¸ìƒˆì‹¹ê¸¸ 11", "m": "ìˆ˜ë™", "lat": 37.1521886, "lng": 127.070315}, {"r": 1001, "n": "ì§„ì–‘í˜¸", "a": "ê²½ë‚¨ ì§„ì£¼ì‹œ ë‚¨ê°•ë¡œ 58 1ì¸µ", "m": "ìë™", "lat": 35.1628066, "lng": 128.0484149}, {"r": 998, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 983, "n": "ê°‘ë¶€ë³µê¶ŒíŒë§¤ì ", "a": "ì„œìš¸ ìš©ì‚°êµ¬ ëŒ€ì‚¬ê´€ë¡œ 80", "m": "ìë™", "lat": 37.5349534, "lng": 126.9992939}, {"r": 973, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 958, "n": "í„°ë¯¸ë„ë¶„ì‹", "a": "ì¶©ë‚¨ ë¶€ì—¬êµ° ë¶€ì¥ëŒ€ë¡œ 65", "m": "ìë™", "lat": 36.278449, "lng": 126.9075881}, {"r": 958, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 957, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 947, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìˆ˜ë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 941, "n": "ë¡œë˜íœ´ê²Œì‹¤", "a": "ê²½ê¸° ìš©ì¸ì‹œ ê¸°í¥êµ¬ ìš©êµ¬ëŒ€ë¡œ 1885", "m": "ìˆ˜ë™", "lat": 37.3229028, "lng": 127.1086433}, {"r": 938, "n": "ì˜¬ì¸(allin)", "a": "ê²½ê¸° í™”ì„±ì‹œ 3.1ë§Œì„¸ë¡œ 1147", "m": "ìë™", "lat": 37.1139739, "lng": 126.8858004}];
            const map = L.map('map').setView([36.5, 127.5], 7);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            
            let cluster = null;

            function getCol(c) {
                if (c >= 10) return "darkred";
                if (c >= 5) return "red";
                if (c >= 3) return "orange";
                if (c >= 2) return "blue";
                return "green";
            }

            function applyFilters() {
                const min = parseInt(document.getElementById('minR').value);
                const max = parseInt(document.getElementById('maxR').value);
                const showA = document.getElementById('chkA').checked;
                const showM = document.getElementById('chkM').checked;

                if (cluster) map.removeLayer(cluster);
                cluster = L.markerClusterGroup({ spiderfyOnMaxZoom: true, showCoverageOnHover: false });

                const filtered = data.filter(d => {
                    return d.r >= min && d.r <= max && 
                           ((showA && d.m === 'ìë™') || (showM && d.m === 'ìˆ˜ë™'));
                });

                // Group by shop for marker display
                const shops = {};
                filtered.forEach(d => {
                    const key = `${d.n}|${d.a}`;
                    if (!shops[key]) shops[key] = { n: d.n, a: d.a, lat: d.lat, lng: d.lng, r: [] };
                    shops[key].r.push(d.r);
                });

                Object.values(shops).forEach(s => {
                    const cnt = s.r.length;
                    const col = getCol(cnt);
                    const marker = L.circleMarker([s.lat, s.lng], {
                        radius: 8 + (cnt * 0.5),
                        fillColor: col, color: "#fff", weight: 2, fillOpacity: 0.8
                    }).bindPopup(`
                        <div style="font-family: sans-serif;">
                            <h4 style="margin:0; color:${col}">${s.n}</h4>
                            <p style="margin:5px 0; font-size:12px;">${s.a}</p>
                            <hr>
                            <b>ë‹¹ì²¨ íšŸìˆ˜: ${cnt}íšŒ</b><br>
                            íšŒì°¨: ${s.r.sort((a,b)=>b-a).join(', ')}
                        </div>
                    `);
                    cluster.addLayer(marker);
                });

                map.addLayer(cluster);
                document.getElementById('curCnt').innerText = filtered.length.toLocaleString();
            }

            applyFilters();
        </script>
    </body>
    </html>
    